# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è –¥–µ–ø–ª–æ—è

## üìã –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤

–ü—Ä–∏ –¥–µ–ø–ª–æ–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö:

### üîë –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

#### 1. `TELEGRAM_BOT_TOKEN`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞  
**–ì–¥–µ –ø–æ–ª—É—á–∏—Ç—å:** –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather) –≤ Telegram  
**–ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è:** `8590756308:AAE6xuAbwAk7delCmWM37hTnr5cQR5ZsDhw`  
**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- GitHub Secrets
- GitLab CI/CD Variables
- Environment Variables –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- Systemd service environment

#### 2. `SITE_URL` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
**–û–ø–∏—Å–∞–Ω–∏–µ:** URL —Å–∞–π—Ç–∞ –¥–ª—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Telegram  
**–§–æ—Ä–º–∞—Ç:** `https://yourdomain.com` (–¥–ª—è production) –∏–ª–∏ `http://127.0.0.1:8000` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)  
**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `http://127.0.0.1:8000`  
**–í–∞–∂–Ω–æ:** –î–ª—è production –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ HTTPS!  
**–ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è:** `https://appointments.example.com`  
**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ú–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

#### 3. `TELEGRAM_USE_WEBHOOK`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å webhook –≤–º–µ—Å—Ç–æ long polling  
**–ó–Ω–∞—á–µ–Ω–∏—è:** `true` –∏–ª–∏ `false`  
**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `false`

#### 4. `TELEGRAM_WEBHOOK_URL`
**–û–ø–∏—Å–∞–Ω–∏–µ:** URL –¥–ª—è webhook (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)  
**–§–æ—Ä–º–∞—Ç:** `https://yourdomain.com/api/telegram/webhook/`  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** HTTPS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

### GitHub Actions

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**
2. –ù–∞–∂–º–∏—Ç–µ **New repository secret**
3. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã:

```
Name: TELEGRAM_BOT_TOKEN
Value: –≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞

Name: DEPLOY_HOST
Value: –≤–∞—à_IP_–∏–ª–∏_–¥–æ–º–µ–Ω

Name: DEPLOY_USER
Value: –≤–∞—à_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å_SSH

Name: DEPLOY_SSH_KEY
Value: –≤–∞—à_–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_SSH_–∫–ª—é—á

Name: DEPLOY_PATH
Value: /path/to/project
```

### GitLab CI/CD

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **CI/CD** ‚Üí **Variables**
2. –ù–∞–∂–º–∏—Ç–µ **Add variable**
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```
Key: TELEGRAM_BOT_TOKEN
Value: –≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
Protected: ‚úì (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
Masked: ‚úì (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

Key: DEPLOY_HOST
Value: –≤–∞—à_IP_–∏–ª–∏_–¥–æ–º–µ–Ω

Key: DEPLOY_USER
Value: –≤–∞—à_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å_SSH

Key: DEPLOY_SSH_KEY
Value: –≤–∞—à_–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_SSH_–∫–ª—é—á
Type: File (–¥–ª—è SSH –∫–ª—é—á–∞)

Key: DEPLOY_PATH
Value: /path/to/project
```

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Systemd)

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ systemd environment

```bash
sudo systemctl set-environment TELEGRAM_BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω"
# SITE_URL –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å
sudo systemctl daemon-reload
sudo systemctl restart telegram-bot
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/systemd/system/telegram-bot.service.d/override.conf`:

```ini
[Service]
Environment="TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω"
# SITE_URL –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å
```

–ó–∞—Ç–µ–º:
```bash
sudo systemctl daemon-reload
sudo systemctl restart telegram-bot
```

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ .env —Ñ–∞–π–ª (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
# SITE_URL –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å
```

–ò –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `python-dotenv` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏:

```python
# –í settings.py
from dotenv import load_dotenv
load_dotenv()
```

## üìù –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –î–ª—è GitHub Actions:

```yaml
env:
  TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
  SITE_URL: ${{ secrets.SITE_URL }}
```

### –î–ª—è GitLab CI:

```yaml
variables:
  TELEGRAM_BOT_TOKEN: $TELEGRAM_BOT_TOKEN
  SITE_URL: $SITE_URL
```

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
TELEGRAM_BOT_TOKEN=8590756308:AAE6xuAbwAk7delCmWM37hTnr5cQR5ZsDhw
SITE_URL=http://127.0.0.1:8000
```

**–í–∞–∂–Ω–æ:** –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`!

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo $TELEGRAM_BOT_TOKEN
echo $SITE_URL

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
python manage.py run_bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ systemd service
sudo systemctl status telegram-bot
sudo systemctl show telegram-bot | grep Environment
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π!**
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ CI/CD —Å–∏—Å—Ç–µ–º–∞—Ö
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
4. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è development –∏ production

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
- –î–ª—è production –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS
- –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Telegram —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

